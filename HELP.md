# Remote Wake Connect - ヘルプガイド

## 目次

1. [基本操作](#基本操作)
2. [詳細設定](#詳細設定)
3. [トラブルシューティング](#トラブルシューティング)
4. [よくある質問](#よくある質問)
5. [技術情報](#技術情報)

## 基本操作

### RDPファイルの読み込み

#### 方法1: ドラッグ&ドロップ
1. エクスプローラーからRDPファイルをアプリケーションウィンドウにドラッグ
2. 「RDPファイル」欄にドロップ
3. ファイルの内容が自動的に読み込まれます

#### 方法2: 参照ボタン
1. 「参照」ボタンをクリック
2. ファイル選択ダイアログでRDPファイルを選択
3. 「開く」をクリック

### Wake-on-LAN機能

#### 自動MACアドレス検出
- RDPファイル読み込み時に自動的にMACアドレスを検索
- ARP、WMI、nbtstatの順で検索実行
- 検出されない場合は手動入力が必要

#### 手動MACアドレス入力
- 形式: `XX:XX:XX:XX:XX:XX` または `XX-XX-XX-XX-XX-XX`
- 大文字・小文字は問いません
- コロン（:）またはハイフン（-）区切りに対応

#### ブロードキャストアドレス設定
- 通常は自動計算されます
- 特殊なネットワーク構成の場合は手動設定

### 接続実行

#### Wake & Connect
1. Wake-on-LANパケットを送信
2. 3秒待機
3. 自動的にRDP接続を開始

#### Wake Only
- Wake-on-LANパケットのみ送信
- 手動でのRDP接続確認に使用

#### Connect Only
- RDP接続のみ実行
- 対象マシンが既に起動している場合に使用

### 直接接続

RDPファイルを使用せずに接続する場合：

1. **IPアドレス/コンピュータ名の入力**
   - IPアドレス例: `192.168.1.100`
   - コンピュータ名例: `DESKTOP-ABC123`
   - ポート付きアドレス例: `server.domain.com:3389`

2. **ポート番号の指定**
   - デフォルト: 3389
   - カスタムポート対応

3. **接続実行**
   - 「Connect Only」ボタンで接続

## 詳細設定

### マルチモニター設定

#### モニター選択
1. 「Use Multimon」にチェック
2. モニターレイアウトで使用したいモニターをクリック
3. 選択されたモニターは青色で表示
4. 設定は自動的に保存されます

#### モニター構成変更の検出
- アプリケーション起動時にモニター構成をチェック
- 変更が検出された場合は警告メッセージを表示
- 設定の再確認を促します

### RDP詳細設定

#### エクスペリエンスタブ
- **接続タイプ**: 自動検出、LAN、ブロードバンド、モデム、カスタム
- **デスクトップ背景**: リモートデスクトップの背景表示
- **フォントスムージング**: フォントの滑らか表示
- **デスクトップコンポジション**: Aero効果の有効化
- **ウィンドウ内容の表示**: ドラッグ時の内容表示
- **メニューアニメーション**: メニューの動的効果
- **視覚スタイル**: テーマの適用
- **ビットマップキャッシュ**: 画像キャッシュの使用
- **自動再接続**: 接続断時の自動復旧

#### ローカルリソースタブ
- **オーディオ**: ローカル、リモート、再生しない
- **オーディオ録音**: リモートマシンでの録音許可
- **キーボード**: キーの組み合わせの適用先
- **プリンター**: ローカルプリンターのリダイレクト
- **クリップボード**: クリップボードの共有
- **スマートカード**: スマートカードのリダイレクト
- **COMポート**: シリアルポートのリダイレクト
- **ドライブ**: ローカルドライブのリダイレクト
- **PnPデバイス**: プラグアンドプレイデバイス

### 接続履歴

#### 履歴の確認
- 右側のグリッドに最大50件の履歴を表示
- 最終接続日時順で並び替え

#### 履歴からの接続
1. 履歴一覧で接続したい項目をダブルクリック
2. 設定が左側のフォームに復元
3. 「Wake & Connect」または「Connect Only」で接続

#### 履歴の検索
- グリッド上部の検索ボックスでフィルタリング
- 名前、IPアドレス、コンピュータ名で検索可能

## トラブルシューティング

### Wake-on-LANが動作しない

#### 対象マシン側の設定確認
1. **BIOS/UEFI設定**
   - Wake-on-LAN機能が有効になっているか確認
   - Fast Boot/Fast Startupが無効になっているか確認

2. **Windowsの設定**
   - デバイスマネージャーでネットワークアダプターのプロパティを開く
   - 「電源管理」タブで「このデバイスで、コンピューターのスタンバイ状態を解除できるようにする」をチェック
   - 「詳細設定」タブで「Wake on Magic Packet」を有効にする

3. **電源設定**
   - 完全シャットダウンを実行（Shift+シャットダウン）
   - 高速スタートアップを無効にする

#### ネットワーク環境の確認
- ファイアウォールでWOLパケット（UDP 9番ポート）が許可されているか
- スイッチやルーターがマジックパケットを中継しているか
- 同一セグメント内での動作確認

### RDP接続ができない

#### 対象マシン側の設定
1. **リモートデスクトップの有効化**
   - 「設定」→「システム」→「リモートデスクトップ」で有効にする
   - または「sysdm.cpl」→「リモート」タブで設定

2. **ファイアウォール設定**
   - Windowsファイアウォールでリモートデスクトップを許可
   - カスタムポートを使用している場合は該当ポートを開放

3. **ユーザー権限**
   - 接続するユーザーが「Remote Desktop Users」グループに所属
   - またはAdministrators権限を持っている

#### ネットワーク接続の確認
```cmd
# 接続テスト
ping [対象IPアドレス]

# ポート接続テスト
telnet [対象IPアドレス] 3389
```

### アプリケーションエラー

#### .NET Runtimeエラー
- .NET 8.0 Runtimeがインストールされているか確認
- [公式サイト](https://dotnet.microsoft.com/download/dotnet/8.0)からダウンロード・インストール

#### 権限エラー
- 管理者権限でアプリケーションを実行
- アンチウイルスソフトの除外設定を確認

#### ファイル破損
- アプリケーションファイルを再ダウンロード
- `connection_history.yaml`ファイルを削除して初期化

## よくある質問

### Q: MACアドレスが検出されません
**A:** 以下の順で確認してください：
1. 対象マシンが過去にネットワーク通信を行ったか
2. ARPテーブルに対象IPアドレスが登録されているか（`arp -a`コマンド）
3. 手動でMACアドレスを入力

### Q: 接続履歴が消えました
**A:** `connection_history.yaml`ファイルが破損している可能性があります。ファイルを削除して再起動すると新しい履歴ファイルが作成されます。

### Q: マルチモニター設定が反映されません
**A:** 以下を確認してください：
1. 「Use Multimon」がチェックされているか
2. モニター構成が変更されていないか
3. RDPファイルに設定が正しく保存されているか

### Q: Jump Listに履歴が表示されません
**A:** Windowsの設定で以下を確認：
1. 「設定」→「個人用設定」→「スタート」
2. 「最近開いた項目をスタート、ジャンプリスト、ファイルエクスプローラーに表示する」がオンになっているか

### Q: カスタムポートで接続できません
**A:** 以下を確認してください：
1. 対象マシンのリモートデスクトップサービスがカスタムポートで動作しているか
2. ファイアウォールで該当ポートが開放されているか
3. ルーターのポートフォワーディング設定（インターネット経由の場合）

## 技術情報

### サポートされるRDPファイル形式
- Microsoft Remote Desktop Protocol（.rdp）
- Windows標準のmstscで作成されたファイル
- サードパーティ製RDPクライアントのファイル（一部）

### 設定ファイル
- **接続履歴**: `connection_history.yaml`（YAML形式）
- **場所**: アプリケーションと同じフォルダ
- **最大件数**: 50件（古いものから自動削除）

### ネットワーク要件
- **Wake-on-LAN**: UDP 9番ポート
- **RDP**: TCP 3389番ポート（デフォルト）
- **Ping**: ICMP Echo Request

### システム制限
- 最大モニター数: 32台
- 履歴保存件数: 50件
- 対応OS: Windows 10/11 (64bit)

### セキュリティ考慮事項
- パスワードは保存されません
- MACアドレスとIPアドレスのみ履歴に保存
- ネットワーク資格情報はWindowsの資格情報マネージャーを使用

## お問い合わせ

技術的な問題やバグ報告は、[GitHubのIssues](https://github.com/aziproducer/RemoteWakeConnect/issues)までお願いします。