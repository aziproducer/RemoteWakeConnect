# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.1.0] - 2025-01-14

### Added
- 🔍 **セッション監視機能**
  - RDP接続前に自動でリモートマシンのセッション状態を確認
  - 他のユーザーが使用中の場合に警告ダイアログを表示
  - Windows Terminal Services (WTS) APIを使用した詳細なセッション情報取得

- 🖥️ **OS種別判定機能**
  - Windows 10/11 Pro（単一セッション制限）を自動判定
  - Windows Server（RDS有り/無し）を自動判定
  - OS種別に応じた適切な警告レベルの設定

- ⚠️ **インテリジェント警告システム**
  - Windows 10/11 Pro: 強制切断リスクを警告
  - Windows Server（RDS無し）: 管理用セッション制限を警告
  - Windows Server（RDS有り）: 情報提供のみ（安全に接続可能）

- 📊 **セッション詳細表示**
  - ユーザー名、ドメイン、セッションタイプの表示
  - アクティブ/切断/アイドル等の状態表示
  - 詳細表示の展開/折りたたみ機能

### Technical Implementation
- Windows Terminal Services API (wtsapi32.dll) P/Invoke実装
- WMI (Windows Management Instrumentation) によるOS情報取得
- RDS (Remote Desktop Services) インストール状態の自動検出
- 非同期処理による応答性の維持

---

## [1.0.1] - 2025-01-14

### Fixed
- 🔧 **履歴選択時のバグ修正**
  - RDPファイル読み込み時にComputerName、Port情報が失われる問題を修正
  - 履歴選択時に直接接続アドレス欄とポート欄が正しく設定されない問題を修正
  - 履歴データとRDPファイルの情報を適切にマージするよう改善

- 📝 **デバッグ機能の追加**
  - 履歴選択時のデバッグログをdebug.logファイルに出力
  - トラブルシューティングのための詳細情報記録

- 🛠️ **コード改善**
  - RDPファイル名生成ロジックの改善（タイムスタンプ除去、元のファイル名維持）
  - Path参照の曖昧性を解消（System.IO.Path明示指定）

---

## [1.0.0] - 2025-01-14

### Added
- 🚀 **Wake-on-LAN統合機能**
  - MACアドレスによるリモートマシンの起動
  - ARP、WMI、nbtstatを使用した自動MACアドレス検出
  - ブロードキャストアドレスの自動計算
  - Wake & Connect（起動→接続）のワンクリック実行

- 🖥️ **リモートデスクトップ接続**
  - RDPファイルのドラッグ&ドロップ読み込み
  - 直接接続機能（RDPファイル不要）
  - カスタムポート番号対応
  - DNS解決によるホスト名からIPアドレス変換

- 📺 **マルチモニター対応**
  - Windows APIを使用した物理モニター検出
  - 個別モニター選択機能
  - モニターレイアウトの視覚的表示
  - モニター設定の自動保存・復元
  - モニター構成変更の検出・警告システム

- 📋 **接続履歴管理**
  - YAML形式での軽量データ保存
  - 最大50件の履歴自動管理
  - リアルタイム検索・フィルタリング
  - ダブルクリックでの設定復元
  - IPアドレスとコンピュータ名の自動分離・整合性チェック

- ⚙️ **RDP詳細設定**
  - **エクスペリエンス設定タブ**
    - 接続タイプ選択（自動検出/LAN/ブロードバンド/モデム/カスタム）
    - 視覚効果の詳細設定（背景、フォントスムージング、コンポジション等）
    - パフォーマンス最適化オプション
  - **ローカルリソース設定タブ**
    - オーディオ再生先の選択
    - キーボードフック設定
    - デバイスリダイレクト（プリンター、クリップボード、ドライブ等）

- 🎯 **Windows統合機能**
  - Jump List統合（タスクバー右クリックメニュー）
  - 履歴からの直接接続・WOL実行
  - ステータスインジケーター表示
  - 接続状態確認（Ping機能）

- 🛡️ **セキュリティ・安定性**
  - データ整合性の自動チェック・修正
  - RDPファイル名の汚染防止
  - 適切なエラーハンドリング
  - メモリリーク対策

### Technical Features
- **.NET 8.0 WPF**アプリケーション
- **単一実行ファイル**対応（publish設定済み）
- **C# 12**言語機能活用
- **MVVM準拠**のクリーンアーキテクチャ
- **Windows API**との適切な統合
- **YamlDotNet**による軽量データ管理

### UI/UX Improvements
- **左右分割レイアウト**による直感的な操作
- モニター設定の下部中央配置
- タブによる設定画面の整理
- 列幅の最適化による情報表示効率化
- レスポンシブなウィンドウサイジング（850x900px）

### Performance Optimizations
- 非同期処理による UI応答性向上
- 効率的なモニター検出アルゴリズム
- メモリ使用量の最適化
- ファイルI/Oの最適化

### Developer Experience
- 包括的なエラーハンドリング
- 詳細なログ出力
- モジュラーなサービス設計
- 拡張性を考慮したアーキテクチャ

---

## バグ修正履歴

### v1.0.0での修正項目
- ✅ IPアドレス欄にコンピュータ名が混入する問題
- ✅ RDP履歴の汚染（毎回異なるファイル名生成）
- ✅ モニター検出が1つしか認識しない問題
- ✅ Assembly.Locationの警告（単一実行ファイル対応）
- ✅ 接続履歴の重複エントリ問題
- ✅ モニター構成変更時のクラッシュ
- ✅ ネットワーク断時の不適切なエラー表示

---

## 既知の制限事項

- Wake-on-LANは同一ネットワークセグメント内でのみ動作
- マルチモニター機能は最大32台まで対応
- 接続履歴は最大50件まで保存
- Windows 10/11のみサポート

---

## 貢献者

- **開発**: Claude Code (Anthropic) & User
- **テスト**: ユーザーコミュニティ
- **フィードバック**: GitHub Issues

---

*このプロジェクトは継続的に改善されています。機能要望やバグ報告は [GitHub Issues](https://github.com/aziproducer/RemoteWakeConnect/issues) までお寄せください。*