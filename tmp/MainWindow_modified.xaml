<Window x:Class="RemoteWakeConnect.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Remote Wake Connect v1.2.0" Height="800" Width="1000"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- ヘッダー -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="5">
            <TextBlock Text="Remote Wake Connect" 
                       Foreground="White" 
                       FontSize="20" 
                       FontWeight="Bold"/>
        </Border>
        
        <!-- メインコンテンツ -->
        <Grid Grid.Row="1" Margin="5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="280"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- 左側: モニター設定 -->
            <GroupBox Grid.Column="0" Header="モニター設定" Margin="0,0,3,0">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- 検出情報（簡略化） -->
                    <TextBlock x:Name="CurrentMonitorConfigText" 
                               Grid.Row="0"
                               Text="モニター情報を取得中..." 
                               TextWrapping="Wrap"
                               FontSize="9"
                               Margin="0,0,0,3"/>
                    
                    <!-- 更新ボタン（小さく） -->
                    <Button x:Name="RefreshMonitorsButton" 
                            Grid.Row="1"
                            Content="更新" 
                            Width="60" 
                            Height="20"
                            FontSize="9"
                            HorizontalAlignment="Left"
                            Margin="0,0,0,3"
                            Click="RefreshMonitorsButton_Click"/>
                    
                    <!-- モニター選択（コンパクト） -->
                    <StackPanel Grid.Row="2">
                        <TextBlock Text="使用するモニター:" FontWeight="Bold" FontSize="9" Margin="0,0,0,2"/>
                        <Border BorderBrush="LightGray" BorderThickness="1" Margin="0,0,0,3">
                            <ScrollViewer MaxHeight="120" VerticalScrollBarVisibility="Auto">
                                <ItemsControl x:Name="MonitorCheckBoxList">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <CheckBox Margin="2,1" 
                                                      IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                      Tag="{Binding Index}"
                                                      Checked="MonitorCheckBox_Checked"
                                                      Unchecked="MonitorCheckBox_Unchecked">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock FontSize="8" FontWeight="Bold" Margin="0,0,3,0">
                                                        <TextBlock.Text>
                                                            <Binding Path="Index" StringFormat="[{0}]"/>
                                                        </TextBlock.Text>
                                                    </TextBlock>
                                                    <TextBlock FontSize="8">
                                                        <TextBlock.Text>
                                                            <MultiBinding StringFormat="{}{0}">
                                                                <Binding Path="Resolution"/>
                                                            </MultiBinding>
                                                        </TextBlock.Text>
                                                    </TextBlock>
                                                    <TextBlock FontSize="8" Foreground="Red" Margin="3,0,0,0" 
                                                               Visibility="{Binding IsPrimary, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                        <TextBlock.Text>(P)</TextBlock.Text>
                                                    </TextBlock>
                                                </StackPanel>
                                            </CheckBox>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>
                    </StackPanel>
                    
                    <!-- 選択ボタン（小さく） -->
                    <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,2,0,0">
                        <Button x:Name="SelectAllMonitorsButton" 
                                Content="すべて選択" 
                                Width="65" 
                                Height="18"
                                FontSize="8"
                                Margin="0,0,3,0" 
                                Click="SelectAllMonitorsButton_Click"/>
                        <Button x:Name="DeselectAllMonitorsButton" 
                                Content="すべて解除" 
                                Width="65" 
                                Height="18"
                                FontSize="8"
                                Click="DeselectAllMonitorsButton_Click"/>
                    </StackPanel>
                    
                    <!-- 画面設定（コンパクト） -->
                    <StackPanel Grid.Row="4" Margin="0,5,0,0">
                        <TextBlock Text="解像度:" FontWeight="Bold" FontSize="9" Margin="0,0,0,2"/>
                        <Slider x:Name="ResolutionSlider" 
                                Minimum="0" 
                                Maximum="10" 
                                Value="5" 
                                TickPlacement="BottomRight" 
                                TickFrequency="2" 
                                IsSnapToTickEnabled="True"
                                Margin="0,0,0,2"
                                ValueChanged="ResolutionSlider_ValueChanged"/>
                        <TextBlock x:Name="ResolutionDisplayText" 
                                   Text="1920 × 1080 px" 
                                   HorizontalAlignment="Center"
                                   FontSize="9"
                                   Margin="0,0,0,3"/>
                        <TextBlock Text="色深度:" FontWeight="Bold" FontSize="9" Margin="0,0,0,2"/>
                        <ComboBox x:Name="ColorDepthComboBox" FontSize="9" Height="20">
                            <ComboBoxItem Content="16 bit" Tag="16"/>
                            <ComboBoxItem Content="24 bit" IsSelected="True" Tag="24"/>
                            <ComboBoxItem Content="32 bit" Tag="32"/>
                        </ComboBox>
                    </StackPanel>
                </Grid>
            </GroupBox>
            
            <!-- セパレーター1 -->
            <GridSplitter Grid.Column="1" 
                          Width="3" 
                          HorizontalAlignment="Center" 
                          VerticalAlignment="Stretch" 
                          Background="#E0E0E0"/>
            
            <!-- 中央: 接続設定 -->
            <TabControl Grid.Column="2" Margin="0,0,3,0">
                <!-- 基本設定タブ -->
                <TabItem Header="基本設定">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                    <!-- RDPファイル読み込み -->
                    <GroupBox Header="RDPファイル" Margin="0,0,0,8">
                        <Grid Margin="8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBox x:Name="RdpFilePathTextBox" 
                                     Grid.Column="0" 
                                     AllowDrop="True"
                                     PreviewDragOver="RdpFilePathTextBox_PreviewDragOver"
                                     Drop="RdpFilePathTextBox_Drop"/>
                            <Button x:Name="BrowseRdpButton" 
                                    Grid.Column="1" 
                                    Content="参照" 
                                    Margin="3,0,0,0"
                                    Click="BrowseRdpButton_Click"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Wake On LAN設定 -->
                    <GroupBox Header="Wake On LAN設定">
                        <Grid Margin="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="コンピュータ:" FontSize="10"/>
                            <TextBox x:Name="ComputerNameTextBox" 
                                     Grid.Row="0" 
                                     Grid.Column="1"
                                     ToolTip="例: DESKTOP-ABC123"/>
                            
                            <Label Grid.Row="1" Grid.Column="0" Content="IP:" FontSize="10"/>
                            <Grid Grid.Row="1" Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="IpAddressTextBox" 
                                         Grid.Column="0"
                                         ToolTip="例: 192.168.1.100"/>
                                <Border x:Name="StatusIndicator" 
                                        Grid.Column="1" 
                                        Width="14" 
                                        Height="14" 
                                        Margin="1,0"
                                        CornerRadius="7"
                                        Background="Gray"
                                        ToolTip="未確認"
                                        MouseEnter="StatusIndicator_MouseEnter"
                                        MouseLeave="StatusIndicator_MouseLeave"/>
                                <Button x:Name="CheckStatusButton" 
                                        Grid.Column="2" 
                                        Content="確認" 
                                        Height="20"
                                        FontSize="10"
                                        Margin="2,0,0,0"
                                        Click="CheckStatusButton_Click"/>
                            </Grid>
                            
                            <Label Grid.Row="2" Grid.Column="0" Content="MAC:" FontSize="10"/>
                            <TextBox x:Name="MacAddressTextBox" 
                                     Grid.Row="2" 
                                     Grid.Column="1"
                                     ToolTip="例: 00:11:22:33:44:55"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- 直接接続設定 -->
                    <GroupBox Header="直接接続設定" Margin="0,8,0,0">
                        <Grid Margin="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="アドレス:" FontSize="10"/>
                            <TextBox x:Name="DirectAddressTextBox" 
                                     Grid.Row="0" 
                                     Grid.Column="1"
                                     ToolTip="コンピュータ名またはIPアドレス"/>
                            
                            <Label Grid.Row="1" Grid.Column="0" Content="ポート:" FontSize="10"/>
                            <TextBox x:Name="PortTextBox" 
                                     Grid.Row="1" 
                                     Grid.Column="1"
                                     Text="3389"
                                     ToolTip="RDPポート番号（デフォルト: 3389）"/>
                            
                            <Label Grid.Row="2" Grid.Column="0" Content="ユーザー:" FontSize="10"/>
                            <TextBox x:Name="UsernameTextBox" 
                                     Grid.Row="2" 
                                     Grid.Column="1"
                                     ToolTip="ユーザー名（オプション）"/>
                        </Grid>
                    </GroupBox>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                
                <!-- エクスペリエンス設定タブ -->
                <TabItem Header="エクスペリエンス">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="8">
                            <GroupBox Header="パフォーマンス設定">
                                <StackPanel Margin="8">
                                    <RadioButton x:Name="PerfAutoDetect" Content="接続品質を自動検出" IsChecked="True" Margin="0,1"/>
                                    <RadioButton x:Name="PerfLAN" Content="LAN (10 Mbps 以上)" Margin="0,1"/>
                                    <RadioButton x:Name="PerfBroadband" Content="ブロードバンド (2 Mbps - 10 Mbps)" Margin="0,1"/>
                                    <RadioButton x:Name="PerfModem" Content="モデム (56 Kbps)" Margin="0,1"/>
                                    <RadioButton x:Name="PerfCustom" Content="カスタム" Margin="0,1"/>
                                </StackPanel>
                            </GroupBox>
                            
                            <GroupBox Header="表示設定" Margin="0,8,0,0">
                                <StackPanel Margin="8">
                                    <CheckBox x:Name="DesktopBackground" Content="デスクトップの背景" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="FontSmoothing" Content="フォントスムージング" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="DesktopComposition" Content="デスクトップコンポジション" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="ShowWindowContents" Content="ドラッグ中にウィンドウの内容を表示" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="MenuAnimations" Content="メニューとウィンドウのアニメーション" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="VisualStyles" Content="ビジュアルスタイル" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="BitmapCaching" Content="持続ビットマップキャッシュ" IsChecked="True" Margin="0,1"/>
                                </StackPanel>
                            </GroupBox>
                            
                            <GroupBox Header="再接続設定" Margin="0,8,0,0">
                                <StackPanel Margin="8">
                                    <CheckBox x:Name="AutoReconnect" Content="接続が切断された場合に自動的に再接続" IsChecked="True" Margin="0,1"/>
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                
                <!-- ローカルリソース設定タブ -->
                <TabItem Header="ローカルリソース">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="8">
                            <GroupBox Header="オーディオ設定">
                                <StackPanel Margin="8">
                                    <RadioButton x:Name="AudioPlayLocal" Content="このコンピュータで再生" IsChecked="True" Margin="0,1"/>
                                    <RadioButton x:Name="AudioPlayRemote" Content="リモートコンピュータで再生" Margin="0,1"/>
                                    <RadioButton x:Name="AudioPlayNone" Content="再生しない" Margin="0,1"/>
                                    <CheckBox x:Name="AudioRecord" Content="リモートオーディオ録音を有効にする" Margin="0,8,0,0"/>
                                </StackPanel>
                            </GroupBox>
                            
                            <GroupBox Header="キーボード設定" Margin="0,8,0,0">
                                <StackPanel Margin="8">
                                    <RadioButton x:Name="KeyboardLocal" Content="このコンピュータ上" IsChecked="True" Margin="0,1"/>
                                    <RadioButton x:Name="KeyboardRemote" Content="リモートコンピュータ上" Margin="0,1"/>
                                    <RadioButton x:Name="KeyboardFullscreen" Content="全画面表示時のみリモートコンピュータ" Margin="0,1"/>
                                </StackPanel>
                            </GroupBox>
                            
                            <GroupBox Header="ローカルデバイスとリソース" Margin="0,8,0,0">
                                <StackPanel Margin="8">
                                    <CheckBox x:Name="RedirectPrinters" Content="プリンター" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="RedirectClipboard" Content="クリップボード" IsChecked="True" Margin="0,1"/>
                                    <CheckBox x:Name="RedirectSmartCards" Content="スマートカード" Margin="0,1"/>
                                    <CheckBox x:Name="RedirectPorts" Content="ポート" Margin="0,1"/>
                                    <CheckBox x:Name="RedirectDrives" Content="ドライブ" Margin="0,1"/>
                                    <CheckBox x:Name="RedirectPnpDevices" Content="サポートされているプラグアンドプレイデバイス" Margin="0,1"/>
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
            
            <!-- セパレーター2 -->
            <GridSplitter Grid.Column="3" 
                          Width="3" 
                          HorizontalAlignment="Center" 
                          VerticalAlignment="Stretch" 
                          Background="#E0E0E0"/>
            
            <!-- 右側: 接続履歴 -->
            <Grid Grid.Column="4" Margin="3,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- セッション状態表示エリア -->
                <Border Grid.Row="0" 
                        BorderBrush="#D0D0D0" 
                        BorderThickness="1" 
                        CornerRadius="3"
                        Background="#F8F8F8"
                        Padding="8"
                        Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="セッション状態" 
                                   FontWeight="Bold" 
                                   FontSize="11"
                                   Foreground="#555555"
                                   Margin="0,0,0,3"/>
                        <TextBlock x:Name="SessionStatusText" 
                                   Text="未確認" 
                                   FontSize="12"
                                   Foreground="#333333"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>
                
                <!-- 履歴ヘッダー -->
                <TextBlock Grid.Row="1" 
                           Text="接続履歴" 
                           FontSize="13" 
                           FontWeight="Bold" 
                           Margin="0,0,0,8"/>
                
                <!-- フィルター -->
                <Grid Grid.Row="2" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBox x:Name="HistorySearchTextBox" 
                             Grid.Column="0"
                             TextChanged="HistorySearchTextBox_TextChanged"
                             Margin="0,0,3,0">
                        <TextBox.Template>
                            <ControlTemplate TargetType="TextBox">
                                <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="2">
                                    <Grid>
                                        <TextBlock Text="検索..." 
                                                   Foreground="Gray" 
                                                   Margin="5,0,0,0" 
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding Text.IsEmpty, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <ScrollViewer x:Name="PART_ContentHost" Margin="2"/>
                                    </Grid>
                                </Border>
                            </ControlTemplate>
                        </TextBox.Template>
                    </TextBox>
                    
                    <Button x:Name="ClearHistoryButton" 
                            Grid.Column="1"
                            Content="クリア" 
                            Width="50" 
                            Height="20"
                            FontSize="10"
                            Click="ClearHistoryButton_Click"/>
                </Grid>
                
                <!-- 履歴一覧 -->
                <DataGrid Grid.Row="3"
                          x:Name="ConnectionHistoryGrid" 
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          SelectionMode="Single"
                          MouseDoubleClick="ConnectionHistoryGrid_MouseDoubleClick"
                          GridLinesVisibility="Horizontal"
                          HeadersVisibility="Column"
                          AlternatingRowBackground="#F8F8F8">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="コンピュータ" 
                                            Binding="{Binding ComputerName}" 
                                            Width="90"/>
                        <DataGridTextColumn Header="IP" 
                                            Binding="{Binding IpAddressValue}" 
                                            Width="80"/>
                        <DataGridTextColumn Header="ポート" 
                                            Binding="{Binding Port}" 
                                            Width="35">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontSize" Value="9"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="ユーザー" 
                                            Binding="{Binding Username}" 
                                            Width="65">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontSize" Value="9"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="MAC" 
                                            Binding="{Binding MacAddress}" 
                                            Width="80">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontSize" Value="9"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="最終接続" 
                                            Binding="{Binding LastConnection, StringFormat='{}{0:MM/dd HH:mm}'}" 
                                            Width="75">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontSize" Value="9"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn Header="選択" Width="30">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="▶" 
                                            Click="UseHistoryButton_Click"
                                            Tag="{Binding}"
                                            Width="25"
                                            Height="18"
                                            FontSize="9"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Grid>
        
        <!-- フッター -->
        <Grid Grid.Row="2" Margin="5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <TextBlock x:Name="StatusText" 
                       Grid.Column="0" 
                       Text="準備完了" 
                       VerticalAlignment="Center"/>
            
            <Button x:Name="WakeButton" 
                    Grid.Column="1" 
                    Content="Wake On LAN" 
                    Width="100" 
                    Height="30" 
                    Margin="0,0,8,0"
                    FontWeight="Bold"
                    Click="WakeButton_Click"/>
            
            <Button x:Name="ConnectButton" 
                    Grid.Column="2" 
                    Content="接続" 
                    Width="100" 
                    Height="30" 
                    FontWeight="Bold"
                    IsDefault="True"
                    Click="ConnectButton_Click"/>
        </Grid>
        
        <!-- CustomResolutionGridを隠しGrid内に設定 -->
        <Grid Visibility="Collapsed">
            <Grid x:Name="CustomResolutionGrid">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="60"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="60"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="DesktopWidthTextBox" Grid.Column="0" Text="1920" FontSize="11" TextChanged="CustomResolution_TextChanged"/>
                <TextBlock Grid.Column="1" Text="×" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                <TextBox x:Name="DesktopHeightTextBox" Grid.Column="2" Text="1080" FontSize="11" TextChanged="CustomResolution_TextChanged"/>
                <TextBlock Grid.Column="3" Text="  px" VerticalAlignment="Center" FontSize="11"/>
            </Grid>
        </Grid>
        
        <!-- MonitorLayoutCanvasを隠しGrid内に設定 -->
        <Grid Visibility="Collapsed">
            <Canvas x:Name="MonitorLayoutCanvas" SizeChanged="MonitorLayoutCanvas_SizeChanged"/>
        </Grid>
    </Grid>
</Window>